# 📘 ファイル・ディレクトリ一覧＋サイズをMarkdownで出力するツール

## 📝 概要

このツールは、**指定したディレクトリまたはファイルの一覧とそのサイズ**をMarkdown (`.md`) 形式で出力するPythonスクリプトです。

- **ファイルとフォルダの一覧**を取得
- 各アイテムの**サイズ**を人間に優しい単位（B, KB, MB, GB, TB）で表示
- 出力は**Markdown形式**
- **プログレスバー**付きで進捗状況を可視化
- **残り推定時間**も表示
- 実行ステップごとに**詳細なステータス表示**
- 入力方法は**クリップボード or 実行時引数**
- 出力先フォルダは**親ディレクトリ名を大文字にしたフォルダ**が自動作成され、その中に保存
- 完了時には**ファイル出力パス**も表示

---

## 🔧 インストール方法

### 1. 必要なPythonパッケージのインストール

```bash
pip install pyperclip
```

### 2. Pythonのバージョン

- Python **3.7以上**推奨
- Windows / macOS / Linux すべて対応

---

## 🚀 使い方

### 1. ファイルをコピーして使う

このスクリプトファイルを `list_dir_to_md.py` などの名前で保存します。

---

### 2. 使い方①：クリップボードからパスを取得して実行

#### 1. パスをコピー（Ctrl+C）

対象となるフォルダやファイルの**パスをコピー**します。

#### 2. スクリプトを実行

```bash
python list_dir_to_md.py
```

クリップボードのパスが自動で読み込まれます。

---

### 3. 使い方②：コマンドライン引数でパスを渡して実行

```bash
python list_dir_to_md.py /path/to/target_directory_or_file
```

---

### 4. 実行例

例えば対象が：

```text
/Users/yourname/Documents/ProjectA/
```

なら、実行後に：

```text
/your/current/working/dir/DOCUMENTS/ProjectA.md
```

というファイルが出力されます。

---

## ✨ 出力結果

出力されるMarkdownファイルはこのような形式になります：

```markdown
# ProjectA
- file1.txt
    - 12.34 KB
- images
    - 1.25 GB
- report.pdf
    - 523.45 KB
```

- 1行目は対象ディレクトリ・ファイル名
- ファイル・フォルダ一覧
- 各アイテムのサイズを**動的な単位**で表示

---

## 📊 実行時の表示（ステータス＆進捗）

実行中は以下のような情報がリアルタイムで表示されます。

```text
ステータス: 初期設定中...
ステータス: 入力パス確認中...
クリップボードから入力パス取得: /path/to/ProjectA
ステータス: 出力先ディレクトリ作成中... (/current/dir/DOCUMENTS)
ステータス: ファイルサイズ計測中...
[#####---------------------------------------------] 10%  5/50  Remaining: 2:30
...
ステータス: ファイルサイズ計測完了
ステータス: ファイル出力中... (/current/dir/DOCUMENTS/ProjectA.md)
ステータス: 完了！ファイル出力先: /current/dir/DOCUMENTS/ProjectA.md
```

- **ステップごとのステータスを明示**
- **プログレスバー**による進捗表示
- **推定残り時間**もリアルタイム更新

---

## ⚙️ 詳細仕様

| 項目                          | 内容 |
|:-------------------------------|:-----|
| 入力方法                       | クリップボード or 実行時引数 |
| ファイル出力形式               | Markdown (`.md`) |
| 出力ファイル名                 | `対象ディレクトリ名.md` or `対象ファイル名.md` |
| 出力ディレクトリ               | 親ディレクトリ名を大文字にしたフォルダ |
| サイズ単位                     | B, KB, MB, GB, TB（動的切替） |
| プログレスバー表示             | あり（進捗10%ごと更新） |
| 残り推定時間表示               | あり |
| ステップごとのステータス表示   | あり |
| 隠しファイルの取り扱い         | 現在はすべて表示対象（除外機能なし） |
| エラーハンドリング             | 入力パス不存在時にエラーメッセージと終了 |

---

## 💬 よくある質問（FAQ）

### Q1: クリップボードに何もないとどうなりますか？
A: コマンドライン引数を探します。それもない場合はエラーで終了します。

---

### Q2: Windowsでも使えますか？
A: はい、Windows / macOS / Linux のすべてに対応しています。

---

### Q3: サブフォルダ内のサイズはカウントされますか？
A: はい、**ディレクトリの場合は中身すべて（再帰的）**をカウントしています。

---

### Q4: ファイルの並び順は？
A: 名前順（アルファベット順）でソートされています。

---

### Q5: 出力先のディレクトリがすでにあったら？
A: 既存のディレクトリがあればそのまま使い、新しく作成はしません（`exist_ok=True`）。

---

## 🛠️ カスタマイズ可能なポイント

- 出力ファイル名に**日付を付加**する
- 出力内容を**Markdownのテーブル形式**にする
- 特定の拡張子ファイルを**除外**する
- ファイルサイズ順に**並び替え**する
- 完了時に**自動でファイルを開く**
- **進捗ログをファイル保存**する

---

## ⚠️ 注意事項

- 本スクリプトはディレクトリ内のファイル数が非常に多い場合、時間がかかることがあります。
- サブフォルダが深い場合も、正確なサイズ計算のために再帰的に探索します。

---

## 🧑‍💻 作者より

このスクリプトは、**直感的で分かりやすく、誰でも簡単に使えるツール**を目指して作られました。  
もし追加機能の要望やフィードバックがあれば、ぜひお寄せください！

---
